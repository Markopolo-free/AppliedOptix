# Digital Loyalty Stamps - Data Model & Examples

## Database Schema

```
referenceLoyaltyStamps/
  ├── loyalty_stamp_001/
  │   ├── id: "loyalty_stamp_001"
  │   ├── name: "Weekend Traveler"
  │   ├── businessName: "eMobility Express"
  │   ├── rewardName: "Free Ride Voucher"
  │   ├── stampDescription: "Earn one stamp for every weekend trip"
  │   ├── stampSuccessMessage: "Excellent! You earned a Weekend Traveler stamp!"
  │   ├── rewardSuccessMessage: "Congratulations! Your free ride voucher has been activated."
  │   ├── stampIcon: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="
  │   ├── expiryType: "daysAfterSignup"
  │   ├── expiryDays: 180
  │   ├── dateAdded: "2025-12-23T14:30:00.000Z"
  │   └── addedBy: "admin@emobility.com"
  │
  ├── loyalty_stamp_002/
  │   ├── id: "loyalty_stamp_002"
  │   ├── name: "Birthday Bonus"
  │   ├── businessName: "eMobility Rewards"
  │   ├── rewardName: "20% Discount"
  │   ├── stampDescription: "Special stamp awarded during customer birthday month"
  │   ├── stampSuccessMessage: "Happy Birthday! You've earned a special bonus stamp!"
  │   ├── rewardSuccessMessage: "Your 20% discount code has been sent to your email!"
  │   ├── stampIcon: "data:image/png;base64,..."
  │   ├── expiryType: "specificDate"
  │   ├── expiryDate: "2025-12-31"
  │   ├── dateAdded: "2025-12-01T10:00:00.000Z"
  │   └── addedBy: "admin@emobility.com"
  │
  └── loyalty_stamp_003/
      ├── id: "loyalty_stamp_003"
      ├── name: "Platinum Member"
      ├── businessName: "eMobility Club"
      ├── rewardName: "VIP Status"
      ├── stampDescription: "Exclusive membership tier for our most loyal customers"
      ├── stampSuccessMessage: "You've achieved Platinum Member status!"
      ├── rewardSuccessMessage: "Welcome to our VIP club! Enjoy exclusive benefits."
      ├── stampIcon: "data:image/png;base64,..."
      ├── expiryType: "never"
      ├── dateAdded: "2025-06-15T09:00:00.000Z"
      └── addedBy: "admin@emobility.com"
```

## Field Details

### id
- **Type**: String
- **Required**: Yes (auto-generated by Firebase)
- **Description**: Unique identifier for the stamp
- **Example**: `"loyalty_stamp_001"`, `"KL5jM9pQr3sT"`

### name
- **Type**: String
- **Required**: Yes
- **Max Length**: 100 characters (recommended)
- **Description**: Display name of the loyalty stamp program
- **Examples**:
  - "Weekend Traveler"
  - "Birthday Bonus"
  - "Platinum Member"
  - "Early Bird Special"

### businessName
- **Type**: String
- **Required**: Yes
- **Max Length**: 100 characters (recommended)
- **Description**: Name of the business or organization offering this stamp
- **Examples**:
  - "eMobility Express"
  - "eMobility Rewards"
  - "eMobility Club"
  - "Partner Business Name"

### rewardName
- **Type**: String
- **Required**: Yes
- **Max Length**: 50 characters (recommended)
- **Description**: The reward customers receive when they collect enough stamps
- **Examples**:
  - "Free Ride Voucher"
  - "20% Discount"
  - "VIP Status"
  - "Bonus Credits"
  - "Free Upgrade"

### stampDescription
- **Type**: String
- **Required**: Yes
- **Max Length**: 500 characters (recommended)
- **Description**: Detailed explanation of how the stamp program works
- **Examples**:
  - "Earn one stamp for every weekend trip. Collect 5 stamps to get a free ride!"
  - "Automatically receive a special stamp during your birthday month. Redeem for 20% off your next ride."
  - "Exclusive membership tier for our most loyal customers. Never expires."

### stampSuccessMessage
- **Type**: String
- **Required**: Yes
- **Max Length**: 200 characters (recommended)
- **Description**: Message displayed to customer when they successfully earn a stamp
- **Examples**:
  - "Excellent! You earned a Weekend Traveler stamp!"
  - "You've earned a bonus stamp for your birthday!"
  - "Congratulations on becoming a Platinum Member!"
  - "Great progress! You're 1 stamp closer to your reward."

### rewardSuccessMessage
- **Type**: String
- **Required**: Yes
- **Max Length**: 200 characters (recommended)
- **Description**: Message displayed when customer successfully claims/redeems their reward
- **Examples**:
  - "Congratulations! Your free ride voucher has been activated."
  - "Your 20% discount code has been sent to your email!"
  - "Welcome to our VIP club! Enjoy exclusive benefits."
  - "Your reward has been added to your account. Valid for 30 days."

### stampIcon
- **Type**: String (Base64-encoded image)
- **Required**: No
- **Format**: `data:image/[png|jpg|gif];base64,[encoded_data]`
- **Max Size**: ~500KB recommended (in base64 form)
- **Description**: Image icon representing the stamp
- **Example**: 
  ```
  "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="
  ```
- **Note**: Stored as base64 to avoid external image dependencies

### expiryType
- **Type**: Enum (String)
- **Required**: Yes
- **Valid Values**: 
  - `"never"` - Stamp never expires
  - `"specificDate"` - All stamps expire on same date
  - `"daysAfterSignup"` - Each stamp expires X days after earned
- **Description**: Determines how the stamp expires
- **Conditional Dependencies**:
  - If `"specificDate"`: `expiryDate` field is required
  - If `"daysAfterSignup"`: `expiryDays` field is required

### expiryDate
- **Type**: String (ISO date format)
- **Required**: Conditional (only if expiryType === "specificDate")
- **Format**: `"YYYY-MM-DD"` (e.g., "2025-12-31")
- **Description**: Calendar date when all stamps expire
- **Examples**:
  - "2025-12-31" (end of year)
  - "2026-06-30" (mid-year)
  - "2025-02-28" (specific milestone)

### expiryDays
- **Type**: Number (Integer)
- **Required**: Conditional (only if expiryType === "daysAfterSignup")
- **Valid Range**: 1 to 3650 (1 to 10 years, recommended)
- **Description**: Number of days from stamp issue date until expiry
- **Examples**:
  - `30` - Expires 1 month after earned
  - `90` - Expires 3 months after earned
  - `180` - Expires 6 months after earned
  - `365` - Expires 1 year after earned

### dateAdded
- **Type**: String (ISO 8601 timestamp)
- **Required**: Yes (auto-set)
- **Format**: `"YYYY-MM-DDTHH:mm:ss.sssZ"`
- **Description**: When the stamp was created in the system
- **Example**: `"2025-12-23T14:30:00.000Z"`
- **Note**: Automatically set by system, not user-editable

### addedBy
- **Type**: String (email address)
- **Required**: Yes (auto-set)
- **Description**: Email address of the user who created this stamp
- **Example**: `"admin@emobility.com"`
- **Note**: Automatically set from current user, not user-editable

## Complete JSON Examples

### Example 1: Expiration by Days After Signup
```json
{
  "id": "loyalty_stamp_001",
  "name": "Weekend Traveler",
  "businessName": "eMobility Express",
  "rewardName": "Free Ride Voucher",
  "stampDescription": "Earn one stamp for every weekend trip. Collect 5 stamps to get a free ride!",
  "stampSuccessMessage": "Excellent! You earned a Weekend Traveler stamp!",
  "rewardSuccessMessage": "Congratulations! Your free ride voucher has been activated.",
  "stampIcon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==",
  "expiryType": "daysAfterSignup",
  "expiryDays": 180,
  "dateAdded": "2025-12-23T14:30:00.000Z",
  "addedBy": "admin@emobility.com"
}
```

### Example 2: Expiration on Specific Date
```json
{
  "id": "loyalty_stamp_002",
  "name": "Year-End Special",
  "businessName": "eMobility Promotions",
  "rewardName": "25% Holiday Discount",
  "stampDescription": "Special promotion running through the end of the year. Earn a stamp with every ride this month!",
  "stampSuccessMessage": "Happy Holidays! You earned a Year-End Special stamp!",
  "rewardSuccessMessage": "Your 25% holiday discount has been applied to your account. Use it before December 31st!",
  "stampIcon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==",
  "expiryType": "specificDate",
  "expiryDate": "2025-12-31",
  "dateAdded": "2025-12-01T00:00:00.000Z",
  "addedBy": "promotions@emobility.com"
}
```

### Example 3: Never Expiring Stamp
```json
{
  "id": "loyalty_stamp_003",
  "name": "Platinum Member",
  "businessName": "eMobility Club",
  "rewardName": "VIP Status",
  "stampDescription": "Exclusive membership tier for our most loyal customers. Enjoy lifetime benefits and special treatment.",
  "stampSuccessMessage": "You've achieved Platinum Member status! Welcome to our elite club.",
  "rewardSuccessMessage": "Welcome to our VIP club! You now enjoy: Priority support, Special rates, Exclusive events, And more!",
  "stampIcon": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg==",
  "expiryType": "never",
  "dateAdded": "2025-06-15T09:00:00.000Z",
  "addedBy": "vip@emobility.com"
}
```

## Query Examples

### Firebase Realtime Database Queries

**Get all stamps:**
```javascript
const stampsRef = ref(db, 'referenceLoyaltyStamps');
const snapshot = await get(stampsRef);
const allStamps = snapshot.val();
```

**Get specific stamp:**
```javascript
const stampRef = ref(db, 'referenceLoyaltyStamps/loyalty_stamp_001');
const snapshot = await get(stampRef);
const stamp = snapshot.val();
```

**Filter stamps by expiry type (client-side):**
```javascript
const neverExpiringStamps = Object.values(allStamps)
  .filter(stamp => stamp.expiryType === 'never');

const temporaryStamps = Object.values(allStamps)
  .filter(stamp => stamp.expiryType !== 'never');
```

## Integration Points

These stamps can be integrated with:

1. **Loyalty Trigger Events**
   - Award stamps when specific events occur
   - Track event to stamp mapping

2. **Customer Reward Programs**
   - Display available stamps to customers
   - Track customer's collected stamps
   - Calculate when stamps expire

3. **Marketing Campaigns**
   - Feature stamps in promotional materials
   - Create limited-time stamp offers
   - Bundle stamps with special campaigns

4. **Mobile Applications**
   - Display stamp icons and descriptions
   - Show progress toward rewards
   - Display expiry information
   - Send notifications when stamps expire

5. **Audit Trail**
   - All changes logged to auditLogs collection
   - Track who created/modified stamps
   - Review complete change history

## Storage Considerations

### Base64 Image Sizing
- **Small PNG icon (32x32)**: ~500 bytes in base64
- **Medium PNG icon (64x64)**: ~2KB in base64
- **Large PNG icon (128x128)**: ~8KB in base64
- **Small JPG thumbnail**: ~1-2KB in base64
- **Medium JPG thumbnail**: ~5-10KB in base64

### Firebase Realtime Database Limits
- Single document (stamp record): No size limit
- Batch operations: Recommended <10MB per write
- Base64 images stored inline are acceptable for small-to-medium images

## Validation Rules

### Client-Side Validation
- All required fields must have non-empty values
- Stamp name must be unique (client-side recommendation)
- Expiry days must be positive integer
- Expiry date must be valid ISO date format
- Messages should be under 200 characters

### Server-Side Recommendations
- Validate all required fields present
- Validate timestamp is reasonable (not in future)
- Validate expiry configuration based on type
- Validate base64 image format
- Enforce field length limits

## Best Practices

1. **Naming**: Use clear, descriptive names
2. **Messages**: Write engaging, action-oriented messages
3. **Icons**: Use high-quality, recognizable icons
4. **Expiry**: Set realistic expiry periods
5. **Testing**: Test complete stamp lifecycle
6. **Documentation**: Document stamp programs for support team
7. **Monitoring**: Review audit logs for usage patterns
